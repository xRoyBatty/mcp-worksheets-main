<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mixed English Practice | ESL Worksheets</title>
    <link rel="stylesheet" href="../../assets/css/worksheet.css">
    <link rel="stylesheet" href="../../assets/css/tasks/multiChoice.css">
    <link rel="stylesheet" href="../../assets/css/tasks/fillBlanks.css">
    <link rel="stylesheet" href="../../assets/css/tasks/matching.css">
    <link rel="stylesheet" href="../../assets/css/tasks/dictation.css">
    <link rel="stylesheet" href="../../assets/css/components/notification.css">
    <!-- Scoring CSS -->
    <link rel="stylesheet" href="../../assets/css/scoring/matching.css">
    <link rel="stylesheet" href="../../assets/css/scoring/multiChoice.css">
    <link rel="stylesheet" href="../../assets/css/scoring/fillBlanks.css">
    <link rel="stylesheet" href="../../assets/css/scoring/dictation.css">
</head>
<body>
    <nav class="nav">
        <a href="../../index.html" class="back-btn">Back to Worksheets</a>
        <div class="progress">
            <div class="progress-bar"></div>
            <span class="progress-text">0% Complete</span>
        </div>
        <div class="level">Level: B1</div>
        <div class="voice">
            <label>Voice:</label>
            <select id="globalVoice"></select>
        </div>
    </nav>

    <main class="worksheet">
        <header class="header">
            <h1>[Worksheet Title]</h1>
            <div class="meta">
                <span>Level: [Level]</span>
                <span>Time: [Time] minutes</span>
                <span>Skills: reading, vocabulary, grammar</span>
            </div>
        </header>

        <div class="tasks">
            <div class="comprehension-container task" data-task-type="comprehension" data-task-id="comprehension-1">
  <div class="comprehension-content">
    {{#if contentType}}
      {{#eq contentType 'video'}}
      <div class="video-content">
        <iframe 
          src="https://www.youtube.com/embed/{{videoId}}" 
          title="Reading Comprehension"
          allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
          allowfullscreen
        ></iframe>
      </div>
      {{/eq}}

      {{#eq contentType 'text'}}
      <div class="reading-content">
        <div class="reading-text">{{{text}}}</div>
        <button class="text-to-speech-btn" aria-label="Read text aloud" title="Read text aloud">
          <i class="fas fa-volume-up"></i>
        </button>
      </div>
      {{/eq}}

      {{#eq contentType 'audio'}}
      <div class="audio-content">
        <div class="audio-controls">
          <button class="play-btn" aria-label="Play audio">
            <i class="fas fa-play"></i>
          </button>
          <button class="pause-btn" aria-label="Pause audio" style="display: none;">
            <i class="fas fa-pause"></i>
          </button>
          <button class="stop-btn" aria-label="Stop audio">
            <i class="fas fa-stop"></i>
          </button>
        </div>
        <div class="audio-progress">
          <progress value="0" max="100"></progress>
          <span class="time-display">00:00 / 00:00</span>
        </div>
      </div>
      {{/eq}}
    {{/if}}
    
    <div class="instructions">
      Read the text and decide if the statements are true or false
    </div>

    <ul class="true-false-list">
      {{#each statements}}
      <li class="true-false-item" data-statement-index="{{@index}}">
        <div class="true-false-statement">
          {{text}}
        </div>
        <div class="true-false-options">
          <label>
            <input type="radio" name="statement_{{@index}}" value="true"> True
          </label>
          <label>
            <input type="radio" name="statement_{{@index}}" value="false"> False
          </label>
        </div>
      </li>
      {{/each}}
    </ul>

    <div class="task-buttons">
      <button class="submit-btn" disabled>Submit</button>
      <button class="reset-btn">Reset</button>
    </div>

    <div class="score-container"></div>
  </div>
</div>
<!-- Multiple Choice Task Template -->
<section class="task multi-Choice" data-task-type="multiChoice" aria-labelledby="{TASK_ID}-title">
    <h2 id="{TASK_ID}-title" class="task-title">{TITLE}</h2>
    <div class="task-instructions">{INSTRUCTIONS}</div>

    <div class="questions-container" role="group" aria-label="Multiple choice questions">
        <!-- Question Template (repeat for each question) -->
        <div class="question" data-index="{INDEX}" role="group" aria-labelledby="{TASK_ID}-q{INDEX}">
            <p id="{TASK_ID}-q{INDEX}" class="question-text">{QUESTION_TEXT}</p>
            
            <div class="options" role="radiogroup" aria-labelledby="{TASK_ID}-q{INDEX}">
                <!-- Option Template (repeat for each option) -->
                <label class="option">
                    <input type="radio" 
                           name="{TASK_ID}-q{INDEX}" 
                           value="{OPTION_VALUE}" 
                           data-correct="{IS_CORRECT}" 
                           aria-labelledby="{TASK_ID}-q{INDEX}-opt{OPTION_INDEX}">
                    <span id="{TASK_ID}-q{INDEX}-opt{OPTION_INDEX}" class="option-text">
                        {OPTION_TEXT}
                    </span>
                </label>
                <!-- End Option Template -->
            </div>
        </div>
        <!-- End Question Template -->
    </div>
</section>

<!-- Template Variables:
{TASK_ID} - Unique identifier for the task
{TITLE} - Task title
{INSTRUCTIONS} - Task instructions
{INDEX} - Question number (1-based)
{QUESTION_TEXT} - The question text
{OPTION_VALUE} - Value for the option
{IS_CORRECT} - "true" for correct option, omit for incorrect
{OPTION_INDEX} - Letter index for the option (a, b, c, etc.)
{OPTION_TEXT} - Text for the option
-->
<!-- Fill in the Blanks Task Template -->
<section class="task fill-Blanks" data-task-type="fillBlanks" aria-labelledby="{TASK_ID}-title">
    <h2 id="{TASK_ID}-title" class="task-title">{TITLE}</h2>
    <div class="task-instructions">{INSTRUCTIONS}</div>

    <div class="task-content">
        <!-- Sentence Template (repeat for each sentence) -->
        <div class="sentence" data-index="{INDEX}">
            <span class="sentence-text">{BEFORE_BLANK}</span>
            <input type="text" 
                   class="blank-input" 
                   data-correct="{CORRECT_ANSWER}" 
                   data-index="{INDEX}"
                   aria-label="Fill in the blank: {SENTENCE_CONTEXT}"
                   autocomplete="off"
                   spellcheck="false">
            <span class="sentence-text">{AFTER_BLANK}</span>
        </div>
        <!-- End Sentence Template -->
    </div>
</section>

<!-- Template Variables:
{TASK_ID} - Unique identifier for the task
{TITLE} - Task title
{INSTRUCTIONS} - Task instructions
{INDEX} - Sentence number (1-based)
{BEFORE_BLANK} - Text before the blank
{CORRECT_ANSWER} - The correct answer for the blank
{SENTENCE_CONTEXT} - Full sentence with blank indicated by underscores
{AFTER_BLANK} - Text after the blank
-->
<!-- Matching Task Template -->
<section class="task matching" data-task-type="matching" aria-labelledby="{TASK_ID}-title">
    <h2 id="{TASK_ID}-title" class="task-title">{TITLE}</h2>
    <div class="task-instructions">{INSTRUCTIONS}</div>

    <div class="pairs-container" role="application" aria-label="Matching pairs exercise">
        <div class="left-items" role="group" aria-label="Left items to match">
            <!-- Left Item Template (repeat for each item) -->
            <div class="match-item" 
                 data-index="{LEFT_INDEX}" 
                 data-pair="{PAIR_ID}" 
                 tabindex="0" 
                 role="button"
                 aria-label="Left item {LEFT_INDEX}: {LEFT_TEXT}"
                 aria-selected="false">
                {LEFT_TEXT}
            </div>
            <!-- End Left Item Template -->
        </div>

        <div class="right-items" role="group" aria-label="Right items to match">
            <!-- Right Item Template (repeat for each item) -->
            <div class="match-item" 
                 data-index="{RIGHT_INDEX}" 
                 data-pair="{PAIR_ID}" 
                 tabindex="0" 
                 role="button"
                 aria-label="Right item {RIGHT_INDEX}: {RIGHT_TEXT}"
                 aria-selected="false">
                {RIGHT_TEXT}
            </div>
            <!-- End Right Item Template -->
        </div>
    </div>

    <!-- Help text for screen readers -->
    <div class="help-text visually-hidden">
        To make a match: First select an item from the left column using Enter or Space, 
        then select its matching pair from the right column. Use arrow keys to navigate 
        between items.
    </div>
</section>

<!-- Template Variables:
{TASK_ID} - Unique identifier for the task
{TITLE} - Task title
{INSTRUCTIONS} - Task instructions
{LEFT_INDEX} - Index for left item (1-based)
{RIGHT_INDEX} - Index for right item (1-based)
{PAIR_ID} - Unique identifier for matching pair
{LEFT_TEXT} - Text for left item
{RIGHT_TEXT} - Text for right item
-->
<!-- Dictation Task Template -->
<section class="task dictation" data-task-type="dictation" aria-labelledby="{TASK_ID}-title">
    <h2 id="{TASK_ID}-title" class="task-title">{TITLE}</h2>
    <div class="task-instructions">{INSTRUCTIONS}</div>

    <div class="task-content">
        <div class="passage" 
             data-text="{DICTATION_TEXT}" 
             data-max-attempts="{MAX_ATTEMPTS}">
            
            <div class="audio-controls">
                <button type="button" 
                        class="play-button" 
                        aria-label="Play dictation">
                    <svg xmlns="http://www.w3.org/2000/svg" 
                         width="24" 
                         height="24" 
                         viewBox="0 0 24 24" 
                         fill="none" 
                         stroke="currentColor" 
                         stroke-width="2" 
                         stroke-linecap="round" 
                         stroke-linejoin="round" 
                         aria-hidden="true">
                        <polygon points="5 3 19 12 5 21 5 3"></polygon>
                    </svg>
                </button>

                <div class="controls-info">
                    <div class="playback-count">
                        Remaining plays: <span class="count">{MAX_ATTEMPTS}</span>
                    </div>
                    
                    <div class="speed-control" role="group" aria-label="Playback speed">
                        <button type="button" 
                                class="speed-button" 
                                data-speed="0.75" 
                                aria-label="Slow speed">
                            0.75x
                        </button>
                        <button type="button" 
                                class="speed-button active" 
                                data-speed="1" 
                                aria-label="Normal speed">
                            1x
                        </button>
                    </div>
                </div>
            </div>

            <div class="input-area">
                <label for="{TASK_ID}-input" class="visually-hidden">
                    Type the dictation text here
                </label>
                <textarea id="{TASK_ID}-input" 
                          class="dictation-input"
                          rows="4"
                          placeholder="Type what you hear..."
                          aria-describedby="{TASK_ID}-help"></textarea>
            </div>

            <div id="{TASK_ID}-help" class="help-text">
                Listen to the audio and type exactly what you hear. 
                You can play the audio up to {MAX_ATTEMPTS} times.
            </div>

            <div class="feedback-area" aria-live="polite"></div>
        </div>
    </div>
</section>

<!-- Template Variables:
{TASK_ID} - Unique identifier for the task
{TITLE} - Task title
{INSTRUCTIONS} - Task instructions
{DICTATION_TEXT} - The correct text to be dictated
{MAX_ATTEMPTS} - Maximum number of times the audio can be played
-->
        </div>

        <footer class="footer">
            <button type="button" id="check">Check Answers</button>
            <button type="button" id="retry">Try Again</button>
        </footer>
    </main>

    <script src="../../assets/js/worksheetManager.js" type="module"></script>
</body>
</html>